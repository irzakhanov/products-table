(this["webpackJsonpproducts-table"]=this["webpackJsonpproducts-table"]||[]).push([[0],{51:function(t,e,c){},74:function(t,e,c){},75:function(t,e,c){"use strict";c.r(e);var n=c(0),r=c.n(n),a=c(21),s=c.n(a),i=c(15),o=c(18),u=(c(51),c(19)),d=c.n(u),j=c(27),l=c(13),b=c(40),O=c.n(b),p=c(4),h=c(41),f=c(5),x=c(14),v={items:{},totalPrice:0,totalCount:0},m=function(t){return Object.keys(t).reduce((function(e,c){return t[c].totalPrice+e}),0)},y=function(t){return Object.keys(t).reduce((function(e,c){return t[c].count+e}),0)},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"cart/add":var c=Object(x.a)(Object(x.a)({},t.items),{},Object(f.a)({},e.payload.id,e.payload));return Object(x.a)(Object(x.a)({},t),{},{items:c,totalPrice:m(c),totalCount:y(c)});default:return t}},S=c(2);var k=function(t){var e=t.gid,c=t.gname,n=t.gprice,a=t.onSelectProduct,s=r.a.useState(0),i=Object(l.a)(s,2),o=i[0],u=i[1],d=r.a.useState(0),j=Object(l.a)(d,2),b=j[0],O=j[1];return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:e}),Object(S.jsx)("td",{children:c}),Object(S.jsx)("td",{children:n}),Object(S.jsx)("td",{children:Object(S.jsx)("input",{type:"number",onChange:function(t){O(b),u(t.target.value*n);var r={id:e,count:Number(t.target.value),totalPrice:t.target.value*n,name:c};a(r)},defaultValue:b})}),Object(S.jsx)("td",{children:o})]})};var _=function(t){var e=t.products,c=t.onSelectProduct,n=Object(p.f)().id,r=[];return r=void 0!==n?e.filter((function(t){return t.rid===n})):e,Object(S.jsx)("table",{children:e&&r.map((function(t,e){return Object(S.jsxs)("tbody",{children:[Object(S.jsx)("tr",{children:Object(S.jsx)("th",{colSpan:"5",children:Object(S.jsx)("h1",{children:t.rname})})}),t.goods.map((function(t){return Object(S.jsx)(k,Object(x.a)(Object(x.a)({},t),{},{onSelectProduct:c}),t.gid)}))]},t.rid+"_"+e)}))})};c(74);var P=function(t){var e=t.products;return Object(S.jsx)("div",{className:"sidebar",children:Object(S.jsx)("ul",{children:e&&e.map((function(t,e){return Object(S.jsx)("li",{children:Object(S.jsx)(i.b,{to:"/products-table/".concat(t.rid),children:t.rname})},t+"_"+e)}))})})},w=c(82);var C=function(){return Object(S.jsx)("div",{style:{display:"flex",width:"100%",height:"100vh",justifyContent:"center",alignItems:"center"},children:Object(S.jsx)(w.a,{size:80})})};var E=function(){var t=Object(o.b)(),e=r.a.useState([]),c=Object(l.a)(e,2),n=c[0],a=c[1],s=r.a.useState(!0),i=Object(l.a)(s,2),u=i[0],b=i[1],f=Object(o.c)((function(t){return t.cart})),x=f.items,v=f.totalCount,m=f.totalPrice,y=function(){var t=Object(j.a)(d.a.mark((function t(){var e,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.prev=1,t.next=4,fetch("https://datainlife.ru/junior_task/get_products.php");case 4:return e=t.sent,t.next=7,e.json();case 7:c=t.sent,a(c),b(!1),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),alert("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a ",t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}();r.a.useEffect((function(){y()}),[]);var g=function(e){t({type:"cart/add",payload:e})},k=function(){var t=Object(j.a)(d.a.mark((function t(){var e,c,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={product:{}},Object.keys(x).forEach((function(t){e.product[t]=x[t].count})),c=Object(h.serialize)(e),t.prev=3,t.next=6,O()({url:"https://datainlife.ru/junior_task/add_basket.php",method:"POST",data:c,headers:{Accept:"application/json","Content-Type":"multipart/form-data"}});case 6:n=t.sent,console.log(n.data),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),alert("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a ",t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(){return t.apply(this,arguments)}}();return u?Object(S.jsx)(C,{}):Object(S.jsxs)("div",{className:"App",children:[Object(S.jsxs)("div",{className:"container",children:[Object(S.jsx)(P,{products:n}),Object(S.jsxs)(p.c,{children:[Object(S.jsx)(p.a,{path:"/products-table",exact:!0,children:Object(S.jsx)(_,{products:n,onSelectProduct:g})}),Object(S.jsx)(p.a,{path:"/products-table/:id",exact:!0,children:Object(S.jsx)(_,{products:n,onSelectProduct:g})})]})]}),Object(S.jsxs)("footer",{className:"footer",children:[Object(S.jsxs)("div",{children:["\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u0437\u0430 \u0442\u043e\u0432\u0430\u0440\u044b: ",Object(S.jsx)("span",{children:m})]}),Object(S.jsxs)("div",{children:["\u041e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e: ",Object(S.jsx)("span",{children:v})]}),Object(S.jsx)("button",{onClick:k,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443"})]})]})},N=c(16),T=c(42),I=Object(N.b)({cart:g}),z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||N.c,A=Object(N.d)(I,z(Object(N.a)(T.a)));s.a.render(Object(S.jsx)(o.a,{store:A,children:Object(S.jsx)(i.a,{children:Object(S.jsx)(E,{})})}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.cd935111.chunk.js.map