{"version":3,"sources":["components/ProductRow.jsx","components/Table.jsx","components/Sidebar.jsx","App.js","redux/actions/cart.js","redux/reducers/cart.js","redux/reducers/index.js","redux/store.js","index.js"],"names":["ProductRow","gid","gname","gprice","onSelectProduct","React","useState","totalPrice","setTotalPrice","value","setValue","type","onChange","e","target","product","id","count","Number","name","defaultValue","Table","products","useParams","filterProducts","undefined","filter","item","rid","map","index","colSpan","rname","goods","Sidebar","className","to","App","dispatch","useDispatch","setProducts","useSelector","data","cart","cartProducts","items","totalCount","useEffect","fetch","then","resp","json","selectProduct","payload","path","exact","onClick","Object","keys","forEach","formData","serialize","axios","url","method","headers","Accept","console","log","initialState","getTotalPrice","reduce","acum","key","getTotalCount","state","action","newItems","rootReducer","combineReducers","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9cf36c98.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nfunction ProductRow({ gid, gname, gprice, onSelectProduct }) {\r\n    const [totalPrice, setTotalPrice] = React.useState(0)\r\n    const [value, setValue] = React.useState(0)\r\n    const handleChange = (e) => {\r\n        setValue(value)\r\n        setTotalPrice(e.target.value * gprice)\r\n        const product = {\r\n            id: gid,\r\n            count: Number(e.target.value),\r\n            totalPrice: e.target.value * gprice,\r\n            name: gname\r\n        }\r\n        onSelectProduct(product)\r\n    }\r\n\r\n    return (\r\n        <tr>\r\n            <td>\r\n                {gid}\r\n            </td>\r\n            <td>\r\n                {gname}\r\n            </td>\r\n            <td>\r\n                {gprice}\r\n            </td>\r\n            <td>\r\n                <input type=\"number\" onChange={handleChange} defaultValue={value}/>\r\n            </td>\r\n            <td>\r\n                {totalPrice}\r\n            </td>\r\n        </tr>\r\n    )\r\n}\r\n\r\nexport default ProductRow\r\n","import React from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport ProductRow from './ProductRow'\r\n\r\nfunction Table({ products, onSelectProduct }) {\r\n    const {id} = useParams()\r\n    let filterProducts = []\r\n    if (id !== undefined) {\r\n        filterProducts = products.filter(item => item.rid === id)\r\n    } else {\r\n        filterProducts = products\r\n    }\r\n    return (\r\n        <table>\r\n            {products &&\r\n                filterProducts.map((product, index) =>\r\n                    <tbody key={product.rid + '_' + index}>\r\n                        <tr>\r\n                            <th colSpan=\"5\"><h1>{product.rname}</h1></th>\r\n                        </tr>\r\n                        {\r\n                            product.goods.map(item =>\r\n                                <ProductRow key={item.gid} {...item} onSelectProduct={onSelectProduct} />\r\n                            )\r\n                        }\r\n                    </tbody>\r\n                )\r\n            }\r\n        </table>\r\n    )\r\n}\r\n\r\nexport default Table\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nfunction Sidebar({ products }) {\r\n    return (\r\n        <div className=\"sidebar\">\r\n            <ul>\r\n                {products &&\r\n                    products.map((item, index) =>\r\n                        <li key={item + '_' + index}>\r\n                            <Link to={`/${item.rid}`}>{item.rname}</Link>\r\n                        </li>\r\n                    )\r\n                }\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Sidebar\r\n","import React from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport axios from 'axios'\r\nimport { Switch, Route } from 'react-router-dom'\r\nimport { serialize } from 'object-to-formdata';\r\n\r\nimport { addToCart } from './redux/actions/cart'\r\n\r\nimport Table from './components/Table'\r\n\r\nimport './App.css';\r\nimport Sidebar from './components/Sidebar';\r\n\r\nfunction App() {\r\n  const dispatch = useDispatch()\r\n  const [products, setProducts] = React.useState([]);\r\n\r\n  const { items: cartProducts, totalCount, totalPrice } = useSelector(data => data.cart)\r\n\r\n  React.useEffect(() => {\r\n    fetch('https://datainlife.ru/junior_task/get_products.php')\r\n      .then(resp => resp.json())\r\n      .then(data => setProducts(data))\r\n  }, [])\r\n\r\n  const onSelectProduct = (selectProduct) => {\r\n    dispatch(addToCart(selectProduct))\r\n  }\r\n\r\n  const handleClick = () => {\r\n    let product = { product: {} }\r\n    Object.keys(cartProducts).forEach(item => {\r\n      product.product[item] = cartProducts[item].count\r\n    })\r\n\r\n    const formData = serialize(product)\r\n\r\n    axios({\r\n      url: 'https://datainlife.ru/junior_task/add_basket.php',\r\n      method: 'POST',\r\n      data: formData,\r\n      headers: {\r\n        Accept: 'application/json',\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    })\r\n      .then(({ data }) => console.log(data))\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"container\">\r\n        <Sidebar\r\n          products={products}\r\n        />\r\n        <Switch>\r\n          <Route path=\"/\" exact>\r\n            <Table\r\n              products={products}\r\n              onSelectProduct={onSelectProduct}\r\n            />\r\n          </Route>\r\n          <Route path=\"/:id\" exact>\r\n            <Table\r\n              products={products}\r\n              onSelectProduct={onSelectProduct}\r\n            />\r\n          </Route>\r\n        </Switch>\r\n      </div>\r\n\r\n      <footer className=\"footer\">\r\n        <div>\r\n          Общая сумма за товары: <span>{totalPrice}</span>\r\n        </div>\r\n        <div>\r\n          Общее колличество: <span>{totalCount}</span>\r\n        </div>\r\n        <button onClick={handleClick}>Добавить в корзину</button>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n\r\n// https://datainlife.ru/junior_task/get_products.php\r\n\r\n// https://datainlife.ru/junior_task/add_basket.php","export const addToCart = (data) => {\r\n    return {\r\n        type: \"ADD_TO_CART\",\r\n        payload: data\r\n    }\r\n}\r\n","const initialState = {\r\n    items: {},\r\n    totalPrice: 0,\r\n    totalCount: 0\r\n}\r\n\r\nconst getTotalPrice = (data) => {\r\n    return Object.keys(data).reduce((acum, key) => data[key].totalPrice + acum, 0);\r\n}\r\n\r\nconst getTotalCount = (data) => {\r\n    return Object.keys(data).reduce((acum, key) => data[key].count + acum, 0);\r\n}\r\n\r\n\r\nconst products = (state = initialState, action) => {\r\n    switch (action.type) {\r\n\r\n        case \"ADD_TO_CART\":\r\n            \r\n            const newItems = {\r\n                ...state.items,\r\n                [action.payload.id]: action.payload\r\n            }\r\n            return {\r\n                ...state,\r\n                items: newItems,\r\n                totalPrice: getTotalPrice(newItems),\r\n                totalCount: getTotalCount(newItems)\r\n            }\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default products;\r\n","import { combineReducers } from 'redux'\r\n\r\nimport cart from './cart';\r\n\r\nconst rootReducer = combineReducers({\r\n    cart\r\n})\r\n\r\nexport default rootReducer;\r\n","import { createStore, compose, applyMiddleware } from 'redux'\r\nimport thunk from 'redux-thunk'\r\n\r\nimport rootReducer from './reducers'\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n\r\nexport default store;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport { Provider } from 'react-redux'\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nimport store from './redux/store'\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router>\r\n      <App />\r\n    </Router>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n\r\n"],"sourceRoot":""}