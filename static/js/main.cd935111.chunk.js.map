{"version":3,"sources":["redux/features/cart.js","components/ProductRow.jsx","components/Table.jsx","components/Sidebar.jsx","components/LoadingBlock.jsx","components/App.jsx","redux/features/index.js","redux/store.js","index.js"],"names":["initialState","items","totalPrice","totalCount","getTotalPrice","data","Object","keys","reduce","acum","key","getTotalCount","count","products","state","action","type","newItems","payload","id","ProductRow","gid","gname","gprice","onSelectProduct","React","useState","setTotalPrice","value","setValue","onChange","e","target","product","Number","name","defaultValue","Table","useParams","filterProducts","undefined","filter","item","rid","map","index","colSpan","rname","goods","Sidebar","className","to","LoadingBlock","style","display","width","height","justifyContent","alignItems","CircularProgress","size","App","dispatch","useDispatch","setProducts","loading","setLoading","useSelector","cart","cartProducts","fetchProducts","a","fetch","response","json","alert","useEffect","selectProduct","handleClick","forEach","formData","serialize","axios","url","method","headers","Accept","console","log","path","exact","onClick","rootReducer","combineReducers","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.cd935111.chunk.js","sourcesContent":["const initialState = {\r\n  items: {},\r\n  totalPrice: 0,\r\n  totalCount: 0,\r\n};\r\n\r\nconst getTotalPrice = (data) => {\r\n  return Object.keys(data).reduce((acum, key) => data[key].totalPrice + acum, 0);\r\n};\r\n\r\nconst getTotalCount = (data) => {\r\n  return Object.keys(data).reduce((acum, key) => data[key].count + acum, 0);\r\n};\r\n\r\nconst products = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case \"cart/add\":\r\n      const newItems = {\r\n        ...state.items,\r\n        [action.payload.id]: action.payload,\r\n      };\r\n      return {\r\n        ...state,\r\n        items: newItems,\r\n        totalPrice: getTotalPrice(newItems),\r\n        totalCount: getTotalCount(newItems),\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default products;\r\n\r\nexport const addToCart = (data) => ({\r\n  type: \"cart/add\",\r\n  payload: data,\r\n});\r\n","import React from \"react\";\r\n\r\nfunction ProductRow({ gid, gname, gprice, onSelectProduct }) {\r\n  const [totalPrice, setTotalPrice] = React.useState(0);\r\n  const [value, setValue] = React.useState(0);\r\n  const handleChange = (e) => {\r\n    setValue(value);\r\n    setTotalPrice(e.target.value * gprice);\r\n    const product = {\r\n      id: gid,\r\n      count: Number(e.target.value),\r\n      totalPrice: e.target.value * gprice,\r\n      name: gname,\r\n    };\r\n    onSelectProduct(product);\r\n  };\r\n\r\n  return (\r\n    <tr>\r\n      <td>{gid}</td>\r\n      <td>{gname}</td>\r\n      <td>{gprice}</td>\r\n      <td>\r\n        <input type=\"number\" onChange={handleChange} defaultValue={value} />\r\n      </td>\r\n      <td>{totalPrice}</td>\r\n    </tr>\r\n  );\r\n}\r\n\r\nexport default ProductRow;\r\n","import React from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport ProductRow from \"./ProductRow\";\r\n\r\nfunction Table({ products, onSelectProduct }) {\r\n  const { id } = useParams();\r\n  let filterProducts = [];\r\n  if (id !== undefined) {\r\n    filterProducts = products.filter((item) => item.rid === id);\r\n  } else {\r\n    filterProducts = products;\r\n  }\r\n  return (\r\n    <table>\r\n      {products &&\r\n        filterProducts.map((product, index) => (\r\n          <tbody key={product.rid + \"_\" + index}>\r\n            <tr>\r\n              <th colSpan=\"5\">\r\n                <h1>{product.rname}</h1>\r\n              </th>\r\n            </tr>\r\n            {product.goods.map((item) => (\r\n              <ProductRow key={item.gid} {...item} onSelectProduct={onSelectProduct} />\r\n            ))}\r\n          </tbody>\r\n        ))}\r\n    </table>\r\n  );\r\n}\r\n\r\nexport default Table;\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nfunction Sidebar({ products }) {\r\n  return (\r\n    <div className=\"sidebar\">\r\n      <ul>\r\n        {products &&\r\n          products.map((item, index) => (\r\n            <li key={item + \"_\" + index}>\r\n              <Link to={`/products-table/${item.rid}`}>{item.rname}</Link>\r\n            </li>\r\n          ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Sidebar;\r\n","import React from \"react\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nfunction LoadingBlock() {\r\n  const styles = {\r\n    container: {\r\n      display: \"flex\",\r\n      width: \"100%\",\r\n      height: \"100vh\",\r\n      justifyContent: \"center\",\r\n      alignItems: \"center\",\r\n    },\r\n  };\r\n  return (\r\n    <div style={styles.container}>\r\n      <CircularProgress size={80} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LoadingBlock;\r\n","import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport axios from \"axios\";\r\nimport { Switch, Route } from \"react-router-dom\";\r\nimport { serialize } from \"object-to-formdata\";\r\nimport { addToCart } from \"../redux/features/cart\";\r\nimport Table from \"./Table\";\r\nimport \"./App.css\";\r\nimport Sidebar from \"./Sidebar\";\r\nimport LoadingBlock from \"./LoadingBlock\";\r\n\r\nfunction App() {\r\n  const dispatch = useDispatch();\r\n  const [products, setProducts] = React.useState([]);\r\n  const [loading, setLoading] = React.useState(true);\r\n\r\n  const { items: cartProducts, totalCount, totalPrice } = useSelector((data) => data.cart);\r\n\r\n  const fetchProducts = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch(\"https://datainlife.ru/junior_task/get_products.php\");\r\n      const data = await response.json();\r\n      setProducts(data);\r\n      setLoading(false);\r\n    } catch (e) {\r\n      alert(\"Что-то пошло не так \", e);\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  const onSelectProduct = (selectProduct) => {\r\n    dispatch(addToCart(selectProduct));\r\n  };\r\n\r\n  const handleClick = async () => {\r\n    let product = { product: {} };\r\n    Object.keys(cartProducts).forEach((item) => {\r\n      product.product[item] = cartProducts[item].count;\r\n    });\r\n\r\n    const formData = serialize(product);\r\n    try {\r\n      const response = await axios({\r\n        url: \"https://datainlife.ru/junior_task/add_basket.php\",\r\n        method: \"POST\",\r\n        data: formData,\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      });\r\n      console.log(response.data);\r\n    } catch (e) {\r\n      alert(\"Что-то пошло не так \", e);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <LoadingBlock />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"container\">\r\n        <Sidebar products={products} />\r\n        <Switch>\r\n          <Route path=\"/products-table\" exact>\r\n            <Table products={products} onSelectProduct={onSelectProduct} />\r\n          </Route>\r\n          <Route path=\"/products-table/:id\" exact>\r\n            <Table products={products} onSelectProduct={onSelectProduct} />\r\n          </Route>\r\n        </Switch>\r\n      </div>\r\n\r\n      <footer className=\"footer\">\r\n        <div>\r\n          Общая сумма за товары: <span>{totalPrice}</span>\r\n        </div>\r\n        <div>\r\n          Общее колличество: <span>{totalCount}</span>\r\n        </div>\r\n        <button onClick={handleClick}>Добавить в корзину</button>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n// https://datainlife.ru/junior_task/get_products.php\r\n\r\n// https://datainlife.ru/junior_task/add_basket.php\r\n","import { combineReducers } from \"redux\";\r\n\r\nimport cart from \"./cart\";\r\n\r\nconst rootReducer = combineReducers({\r\n  cart,\r\n});\r\n\r\nexport default rootReducer;\r\n","import { createStore, compose, applyMiddleware } from \"redux\";\r\nimport thunk from \"redux-thunk\";\r\n\r\nimport rootReducer from \"./features\";\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)));\r\n\r\nexport default store;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport \"./index.css\";\r\nimport App from \"./components/App\";\r\n\r\nimport store from \"./redux/store\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router>\r\n      <App />\r\n    </Router>\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}